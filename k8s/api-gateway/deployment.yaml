apiVersion: apps/v1
kind: Deployment
metadata:
  name: api-gateway
  labels:
    app: api-gateway
spec:
  replicas: 2
  selector:
    matchLabels:
      app: api-gateway
  template:
    metadata:
      labels:
        app: api-gateway
    spec:
      containers:
        - name: api-gateway
          image: aidevops/api-gateway:latest
          ports:
            - containerPort: 8080
          env:
            - name: USER_MANAGEMENT_URL
              value: http://user-management:8081
            - name: INFRASTRUCTURE_MONITOR_URL
              value: http://infrastructure-monitor:8082
            - name: AI_PREDICTION_URL
              value: http://ai-prediction:8083
            - name: LOG_ANALYSIS_URL
              value: http://log-analysis:8084
            - name: CICD_OPTIMIZATION_URL
              value: http://cicd-optimization:8085
            - name: RESOURCE_OPTIMIZATION_URL
              value: http://resource-optimization:8086
            - name: NATURAL_LANGUAGE_URL
              value: http://natural-language:8088
            - name: NOTIFICATION_URL
              value: http://notification:8087
            - name: REPORTING_URL
              value: http://reporting:8089
---
apiVersion: v1
kind: Service
metadata:
  name: api-gateway
spec:
  selector:
    app: api-gateway
  ports:
    - port: 80
      targetPort: 8080
      protocol: TCP
      name: http

